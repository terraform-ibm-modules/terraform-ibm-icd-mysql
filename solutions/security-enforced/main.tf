module "mysql" {
  source                                               = "../fully-configurable"
  ibmcloud_api_key                                     = var.ibmcloud_api_key
  ibmcloud_kms_api_key                                 = var.ibmcloud_kms_api_key
  existing_resource_group_name                         = var.existing_resource_group_name
  prefix                                               = var.prefix
  provider_visibility                                  = "public"
  region                                               = var.region
  mysql_version                                        = var.mysql_version
  name                                                 = var.prefix != null ? "${var.prefix}-${var.name}" : var.name
  existing_mysql_instance_crn                          = var.existing_mysql_instance_crn
  skip_mysql_kms_auth_policy                           = var.skip_mysql_kms_auth_policy
  use_ibm_owned_encryption_key                         = var.use_ibm_owned_encryption_key
  kms_encryption_enabled                               = true
  existing_kms_key_crn                                 = var.existing_kms_key_crn
  existing_kms_instance_crn                            = var.existing_kms_instance_crn
  existing_backup_kms_key_crn                          = var.existing_backup_kms_key_crn
  kms_endpoint_type                                    = "private"
  key_ring_name                                        = var.key_ring_name
  key_name                                             = var.key_name
  use_default_backup_encryption_key                    = var.use_default_backup_encryption_key
  existing_secrets_manager_instance_crn                = var.existing_secrets_manager_instance_crn
  existing_secrets_manager_endpoint_type               = "private"
  skip_mysql_secrets_manager_auth_policy               = var.skip_mysql_secrets_manager_auth_policy
  access_tags                                          = var.access_tags
  tags                                                 = var.tags
  users                                                = var.users
  admin_pass                                           = var.admin_pass
  admin_pass_secrets_manager_secret_group              = var.admin_pass_secrets_manager_secret_group
  use_existing_admin_pass_secrets_manager_secret_group = var.use_existing_admin_pass_secrets_manager_secret_group
  admin_pass_secrets_manager_secret_name               = var.admin_pass_secrets_manager_secret_name
  members                                              = var.members
  member_host_flavor                                   = var.member_host_flavor
  member_memory_mb                                     = var.member_memory_mb
  member_disk_mb                                       = var.member_disk_mb
  member_cpu_count                                     = var.member_cpu_count
  auto_scaling                                         = var.auto_scaling
  configuration                                        = var.configuration
  service_credential_names                             = var.service_credential_names
  service_credential_secrets                           = var.service_credential_secrets
  service_endpoints                                    = "private"
  backup_crn                                           = var.backup_crn
  remote_leader_crn                                    = var.remote_leader_crn
}
